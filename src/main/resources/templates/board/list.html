<!DOCTYPE html>
<html lang="en">

<head th:replace="~{common/head}">

</head>

<body>

  <div th:replace="~{common/header}">

  </div>

  <nav th:replace="~{common/nav}">

  </nav>

  <div class="container mt-5">
    <div class="row">
      <!-- [BOARD LIST] -->
      <table class="table table-hover">
        <thead>
          <tr>
            <th>번호</th>
            <th>제목</th>
            <th>작성자</th>
            <th>추천</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="board : ${list}" th:attr="id=${board.id}" class="board-list">
            <td th:text="${board.id}"></td>
            <td th:text="${board.title}"></td>
            <td th:text="${board.userName}"></td>
            <td th:text="${board.likeCount}"></td>
          </tr>
        </tbody>
      </table>

      <!-- [WRITE BUTTON] -->
       <div th:if="${session.user_info} != null"
            style="width: 100%;">
        <button type="button" class="btn btn-primary btn-block" id="write-btn" style="width: 100%;">글쓰기</button>
          <script>
            document.querySelector('#write-btn').addEventListener('click', () => {
              location = '/board/write';
            });
          </script>
       </div>

      <!-- [SEARCH] -->
      <div style="margin-top: 10px;">
        <form>
          <div class="input-group">
            <input type="text" class="form-control" name="search" placeholder="Search" th:value="${search}">
            <div class="input-group-btn">
              <button class="btn btn-default" type="submit">
                <i class="glyphicon glyphicon-search"></i>
              </button>
            </div>
          </div>
        </form>
      </div>

      <!-- [PAGE] -->
      <ul class="pagination" style="display: flex; justify-content: center; margin-top: 10px;">
        <!-- 이전 페이지 리스트 (ex. curr=(11, 20), prev=(1, 10))-->
        <li class="page-item" th:if="${startPage} != 1">
          <a class="page-link" th:href="@{/board/list(page=${startPage - 1}, search=${param.search})}"
            th:text="이전"></a>
        </li>
        <!-- 페이지 목록  (ex. curr=(1, 10)) -->
        <li th:class="@{|page-item ${page == pageNumber ? 'active' : ''}}"
          th:each="pageNumber : ${#numbers.sequence(startPage, endPage)}">
          <a class="page-link" th:href="@{/board/list(page=${pageNumber}, search=${param.search})}"
            th:text="${pageNumber}"></a>
        </li>
        <!-- 다음 페이지 리스트 (ex. curr=(1, 10), next=(11, 20)) -->
        <li class="page-item" th:if="${endPage} % 10 == 0">
          <a class="page-link" th:href="@{/board/list(page=${endPage + 1}, search=${param.search})}"
            th:text="다음"></a>
        </li>
      </ul>
      
    </div>
  </div>

  <div th:replace="~{common/footer}">
  </div>

  <script>
    document.querySelectorAll('.board-list').forEach((board_item) => {
      board_item.addEventListener('click', () => {
        location.href = `/board/view/${board_item.id}`;
      });
    });
  </script>

</body>

</html>